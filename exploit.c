#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <stdint.h>

/* Stack buffer overflow program */

uint32_t n=0,c=0,d=0,v=0,swap=0;

FILE *fp = NULL;

void Sort()
{
    uint32_t array[5];

    printf(".txt file contains:\n");
    char line[sizeof(uint32_t) * 2 + 1] = {0};
    while(fgets(line, sizeof(line), fp))
    {
        if (strlen((char *)line) > 1)
        {b 
            sscanf(line, "%x",&(array[n]));
            printf("%x\n", array[n]);
            ++n;
        }
    }
    fclose(fp);

#if 1 //change to a 0 and recompile to not sortb 
 for (c = 0 ;c < (n-1) ; c++)
 {
     v = c;
     for(d = (c + 1); d < n; d++)
     {
         if (array[d] < array [v])
         {  swap = array[d];
            array[d] = array[v];
            array[v] = swap;
         }
     }
 }
 #endif
 //output sorting result

    printf("\nSorted List in ascending order:\n");
    for (c = 0 ; c < n ; c++ )
        printf("%x\n", array[c]);
}

int main(int argc, char **argv)
{
    if(argc!=2)
    {
        printf("Usage: ./exploit file_name\n");
        return -1;
    }

    fp = fopen(argv[1], "rb");
    Sort();

    return 0;
}
